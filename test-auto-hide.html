<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¸¬è©¦è‡ªå‹•éš±è—åŠŸèƒ½</title>
    <style>
        body {
            font-family: 'Microsoft JhengHei', sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #1a1a2e;
            color: #eee;
        }

        .container {
            background: #16213e;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        h1 {
            color: #4ecca3;
            margin-bottom: 20px;
        }

        button {
            background: #4ecca3;
            color: #16213e;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin: 10px 5px;
            transition: all 0.3s;
        }

        button:hover {
            background: #45b393;
            transform: translateY(-2px);
        }

        button.danger {
            background: #e74c3c;
        }

        button.danger:hover {
            background: #c0392b;
        }

        .info {
            background: #0f3460;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            border-left: 4px solid #4ecca3;
        }

        .result {
            background: #0f3460;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }

        .warning {
            background: #f39c12;
            color: #16213e;
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ğŸ§ª æ¸¬è©¦è‡ªå‹•éš±è—åŠŸèƒ½</h1>

        <div class="info">
            <strong>åŠŸèƒ½èªªæ˜ï¼š</strong><br>
            ç•¶ç”¢å“åº«å­˜ç‚º 0 è¶…é 2 å¤©æ™‚ï¼Œè©²ç”¢å“æœƒåœ¨ç›¤é»é é¢è‡ªå‹•éš±è—ã€‚
        </div>

        <div class="warning">
            âš ï¸ æ­¤æ¸¬è©¦æœƒä¿®æ”¹ localStorage ä¸­çš„æ—¥æœŸè³‡æ–™
        </div>

        <h3>æ¸¬è©¦æ­¥é©Ÿï¼š</h3>

        <button onclick="viewCurrentData()">1ï¸âƒ£ æŸ¥çœ‹ç•¶å‰è¿½è¹¤è³‡æ–™</button>
        <button onclick="addTestData()">2ï¸âƒ£ æ–°å¢æ¸¬è©¦è³‡æ–™ï¼ˆ3å¤©å‰ï¼‰</button>
        <button onclick="addTestData2Days()">3ï¸âƒ£ æ–°å¢æ¸¬è©¦è³‡æ–™ï¼ˆ2å¤©å‰ï¼‰</button>
        <button onclick="addTestData1Day()">4ï¸âƒ£ æ–°å¢æ¸¬è©¦è³‡æ–™ï¼ˆ1å¤©å‰ï¼‰</button>
        <button onclick="clearData()" class="danger">ğŸ—‘ï¸ æ¸…é™¤æ‰€æœ‰è¿½è¹¤è³‡æ–™</button>

        <div id="result" class="result"></div>

        <div class="info" style="margin-top: 30px;">
            <strong>é©—è­‰æ–¹å¼ï¼š</strong><br>
            1. é»æ“Šã€Œæ–°å¢æ¸¬è©¦è³‡æ–™ã€æŒ‰éˆ•<br>
            2. é‡æ–°æ•´ç†ç›¤é»é é¢<br>
            3. æª¢æŸ¥æ¸¬è©¦ç”¢å“æ˜¯å¦è¢«éš±è—ï¼ˆ3å¤©å‰çš„æ‡‰è©²éš±è—ï¼Œ2å¤©å‰å’Œ1å¤©å‰çš„æ‡‰è©²é¡¯ç¤ºï¼‰
        </div>
    </div>

    <script>
        function viewCurrentData() {
            const data = localStorage.getItem('zeroStockDates');
            const result = document.getElementById('result');

            if (!data) {
                result.textContent = 'ç›®å‰æ²’æœ‰è¿½è¹¤è³‡æ–™';
                return;
            }

            try {
                const parsed = JSON.parse(data);
                const today = new Date();

                let output = 'ç•¶å‰è¿½è¹¤çš„ç”¢å“ï¼š\n\n';

                for (const [productId, dateStr] of Object.entries(parsed)) {
                    const zeroDate = new Date(dateStr);
                    const daysDiff = Math.floor((today - zeroDate) / (1000 * 60 * 60 * 24));
                    const shouldHide = daysDiff > 2;

                    output += `ç”¢å“ ID: ${productId}\n`;
                    output += `  åº«å­˜ç‚º0æ—¥æœŸ: ${dateStr}\n`;
                    output += `  å·²ç¶“éå¤©æ•¸: ${daysDiff} å¤©\n`;
                    output += `  æ˜¯å¦éš±è—: ${shouldHide ? 'âœ… æ˜¯ï¼ˆè¶…é2å¤©ï¼‰' : 'âŒ å¦'}\n\n`;
                }

                result.textContent = output;
            } catch (e) {
                result.textContent = 'è§£æè³‡æ–™å¤±æ•—: ' + e.message;
            }
        }

        function addTestData() {
            const threeDaysAgo = new Date();
            threeDaysAgo.setDate(threeDaysAgo.getDate() - 3);
            const dateStr = threeDaysAgo.toISOString().split('T')[0];

            const data = localStorage.getItem('zeroStockDates');
            const parsed = data ? JSON.parse(data) : {};

            parsed['test-product-3days'] = dateStr;

            localStorage.setItem('zeroStockDates', JSON.stringify(parsed));

            document.getElementById('result').textContent =
                `âœ… å·²æ–°å¢æ¸¬è©¦è³‡æ–™\n\n` +
                `ç”¢å“ ID: test-product-3days\n` +
                `åº«å­˜ç‚º0æ—¥æœŸ: ${dateStr}\n` +
                `ï¼ˆ3å¤©å‰ï¼Œæ‡‰è©²æœƒè¢«éš±è—ï¼‰\n\n` +
                `è«‹é‡æ–°æ•´ç†ç›¤é»é é¢æŸ¥çœ‹æ•ˆæœ`;
        }

        function addTestData2Days() {
            const twoDaysAgo = new Date();
            twoDaysAgo.setDate(twoDaysAgo.getDate() - 2);
            const dateStr = twoDaysAgo.toISOString().split('T')[0];

            const data = localStorage.getItem('zeroStockDates');
            const parsed = data ? JSON.parse(data) : {};

            parsed['test-product-2days'] = dateStr;

            localStorage.setItem('zeroStockDates', JSON.stringify(parsed));

            document.getElementById('result').textContent =
                `âœ… å·²æ–°å¢æ¸¬è©¦è³‡æ–™\n\n` +
                `ç”¢å“ ID: test-product-2days\n` +
                `åº«å­˜ç‚º0æ—¥æœŸ: ${dateStr}\n` +
                `ï¼ˆ2å¤©å‰ï¼Œä¸æ‡‰è©²è¢«éš±è—ï¼‰\n\n` +
                `è«‹é‡æ–°æ•´ç†ç›¤é»é é¢æŸ¥çœ‹æ•ˆæœ`;
        }

        function addTestData1Day() {
            const oneDayAgo = new Date();
            oneDayAgo.setDate(oneDayAgo.getDate() - 1);
            const dateStr = oneDayAgo.toISOString().split('T')[0];

            const data = localStorage.getItem('zeroStockDates');
            const parsed = data ? JSON.parse(data) : {};

            parsed['test-product-1day'] = dateStr;

            localStorage.setItem('zeroStockDates', JSON.stringify(parsed));

            document.getElementById('result').textContent =
                `âœ… å·²æ–°å¢æ¸¬è©¦è³‡æ–™\n\n` +
                `ç”¢å“ ID: test-product-1day\n` +
                `åº«å­˜ç‚º0æ—¥æœŸ: ${dateStr}\n` +
                `ï¼ˆ1å¤©å‰ï¼Œä¸æ‡‰è©²è¢«éš±è—ï¼‰\n\n` +
                `è«‹é‡æ–°æ•´ç†ç›¤é»é é¢æŸ¥çœ‹æ•ˆæœ`;
        }

        function clearData() {
            if (confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰è¿½è¹¤è³‡æ–™å—ï¼Ÿ')) {
                localStorage.removeItem('zeroStockDates');
                document.getElementById('result').textContent = 'âœ… å·²æ¸…é™¤æ‰€æœ‰è¿½è¹¤è³‡æ–™';
            }
        }

        // é é¢è¼‰å…¥æ™‚é¡¯ç¤ºç•¶å‰è³‡æ–™
        window.onload = viewCurrentData;
    </script>
</body>

</html>